<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-private-networks/tutorials/kubernetes/multi-cluster" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Deploy Besu across multiple Kubernetes clusters across multiple cloud providers | Besu documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://besu.hyperledger.org/private-networks/tutorials/kubernetes/multi-cluster"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deploy Besu across multiple Kubernetes clusters across multiple cloud providers | Besu documentation"><meta data-rh="true" name="description" content="Deploy Besu across multiple Kubernetes clusters across multiple cloud providers"><meta data-rh="true" property="og:description" content="Deploy Besu across multiple Kubernetes clusters across multiple cloud providers"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://besu.hyperledger.org/private-networks/tutorials/kubernetes/multi-cluster"><link data-rh="true" rel="alternate" href="https://besu.hyperledger.org/private-networks/tutorials/kubernetes/multi-cluster" hreflang="en"><link data-rh="true" rel="alternate" href="https://besu.hyperledger.org/private-networks/tutorials/kubernetes/multi-cluster" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KD07N5GM2B"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KD07N5GM2B",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-THG37T4",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script><link rel="stylesheet" href="/assets/css/styles.45085e0e.css">
<script src="/assets/js/runtime~main.9453bf07.js" defer="defer"></script>
<script src="/assets/js/main.8b526d48.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-THG37T4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-reversed.svg" alt="Besu" class="themedComponent_mlkZ themedComponent--light_NVdE" width="100"><img src="/img/logo-reversed.svg" alt="Besu" class="themedComponent_mlkZ themedComponent--dark_xIcU" width="100"></div></a><a class="navbar__item navbar__link" docid="index" href="/public-networks">Public networks</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" docid="index" href="/private-networks">Private networks</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link header-chatbot-link" href="/public-networks/chatbot"></a><a href="https://github.com/hyperledger/besu/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><a href="https://discord.gg/hyperledger" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link"></a><a href="https://twitter.com/HyperledgerBesu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-twitter-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/private-networks">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/private-networks/get-started">Get started</a><button aria-label="Collapse sidebar category &#x27;Get started&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/get-started/system-requirements">System requirements</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/private-networks/get-started/install">Install Besu</a><button aria-label="Expand sidebar category &#x27;Install Besu&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/get-started/start-node">Start Besu</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/private-networks/how-to">How to</a><button aria-label="Expand sidebar category &#x27;How to&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/private-networks/concepts">Concepts</a><button aria-label="Expand sidebar category &#x27;Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/private-networks/tutorials">Tutorials</a><button aria-label="Collapse sidebar category &#x27;Tutorials&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/quickstart">Quorum Developer Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/qbft">Create a QBFT network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/private-networks/tutorials/ibft">Create an IBFT 2.0 network</a><button aria-label="Expand sidebar category &#x27;Create an IBFT 2.0 network&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/clique">Create a Clique network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/ethash">(Deprecated) Create an Ethash network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/private-networks/tutorials/privacy">(Deprecated) Create a privacy enabled network</a><button aria-label="Expand sidebar category &#x27;(Deprecated) Create a privacy enabled network&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/permissioning">Create a permissioned network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/private-networks/tutorials/contracts">Deploy a smart contract</a><button aria-label="Expand sidebar category &#x27;Deploy a smart contract&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/private-networks/tutorials/kubernetes">Deploy using Kubernetes</a><button aria-label="Collapse sidebar category &#x27;Deploy using Kubernetes&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/playground">Local playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/cluster">Create a cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/charts">Deploy charts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/quorum-explorer">Use the Quorum Explorer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/maintenance">Maintenance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/kubernetes/production">Production</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/private-networks/tutorials/kubernetes/multi-cluster">Deploy Besu across multiple Kubernetes clusters across multiple cloud providers</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/private-networks/tutorials/azure">Deploy using Microsoft Azure</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/private-networks/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/private-networks/chatbot">Chatbot</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><footer class="theme-doc-footer docusaurus-mt-lg margin-top--sm"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/private-networks">private networks</a></li></ul></div></div></footer><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deploy Besu across multiple Kubernetes clusters across multiple cloud providers</h1></header>
<p>The following tutorial is just one of many ways to connect nodes in one K8S cluster to nodes in another K8S
cluster across multiple cloud provider - in this case <a href="https://aws.amazon.com/eks/" target="_blank" rel="noopener noreferrer">Amazon Elastic Kubernetes Service (EKS)</a>
and <a href="https://azure.microsoft.com/en-au/products/kubernetes-service" target="_blank" rel="noopener noreferrer">Azure Kubernetes Service (AKS)</a></p>
<p>This tutorial walks you through using AWS as the main cluster and adding an extra node in Azure to the existing pool</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="steps">Steps<a href="#steps" class="hash-link" aria-label="Direct link to Steps" title="Direct link to Steps">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-an-awc-vpc">1. Create an AWC VPC<a href="#1-create-an-awc-vpc" class="hash-link" aria-label="Direct link to 1. Create an AWC VPC" title="Direct link to 1. Create an AWC VPC">​</a></h4>
<ol>
<li>Use a CIDR block that doesn&#x27;t overlap with that of Azure eg <code>10.0.0.0/16</code></li>
<li>Create the EKS cluster as normal and use the default Kubernetes service range <code>172.20.0.0/16</code></li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-an-azure-virtual-network">2. Create an Azure Virtual Network<a href="#2-create-an-azure-virtual-network" class="hash-link" aria-label="Direct link to 2. Create an Azure Virtual Network" title="Direct link to 2. Create an Azure Virtual Network">​</a></h4>
<ol>
<li>Use a CIDR block that doesn&#x27;t overlap with that of AWS eg <code>10.1.0.0/16</code></li>
<li>It is also recommended to create a subnet for the Gateway and use a CIDR of <code>/24</code> eg <code>10.1.1.0/24</code></li>
<li>Create the AKS cluster as normal and use the different Kubernetes service range
<code>10.2.0.0/16</code> (the default <code>10.0.0.0/16</code> overlaps with the AWS VPC CIDR block)</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-connect-the-aws-vpc-and-azure-vnet-with-a-site-to-site-vpn">3. Connect the AWS VPC and Azure VNet with a site to site VPN<a href="#3-connect-the-aws-vpc-and-azure-vnet-with-a-site-to-site-vpn" class="hash-link" aria-label="Direct link to 3. Connect the AWS VPC and Azure VNet with a site to site VPN" title="Direct link to 3. Connect the AWS VPC and Azure VNet with a site to site VPN">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="31-on-the-azure-side-create-a-virtual-network-gateway">3.1 On the Azure side create a Virtual Network Gateway<a href="#31-on-the-azure-side-create-a-virtual-network-gateway" class="hash-link" aria-label="Direct link to 3.1 On the Azure side create a Virtual Network Gateway" title="Direct link to 3.1 On the Azure side create a Virtual Network Gateway">​</a></h5>
<p>In the AZure VNet, create a Virtual Network Gateway with the following settings</p>
<table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>SKU</td><td>VpnGw2AZ (default)</td></tr><tr><td>Gateway Type</td><td>VPN</td></tr><tr><td>VPN Type</td><td>Route-based</td></tr><tr><td>Virtual Network</td><td>Use the network in step 2.1</td></tr><tr><td>Gateway subnet</td><td>Use the subnet from step 2.2</td></tr><tr><td>Public IP Address</td><td>Create new</td></tr><tr><td>Enable active-active mode</td><td>Disabled</td></tr><tr><td>Configure BGP</td><td>Disabled</td></tr></tbody></table>
<p>The other settings can remain as defaults or set to suit your requirements. Once this is complete
please note down the IP address that was created for the Virtual Network Gateway</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="32-on-the-aws-side-create-a-customer-gateway">3.2 On the AWS side create a Customer Gateway<a href="#32-on-the-aws-side-create-a-customer-gateway" class="hash-link" aria-label="Direct link to 3.2 On the AWS side create a Customer Gateway" title="Direct link to 3.2 On the AWS side create a Customer Gateway">​</a></h5>
<p>This Customer Gateway points to the Azure Virtual Network Gateay from step 3.1</p>
<table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Routing</td><td>Static</td></tr><tr><td>IP Address</td><td>Use the IP of the Virtual Network Gateway in step 3.1</td></tr></tbody></table>
<p>The other settings can remain as defaults or set to suit your requirements</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="33-on-the-aws-side-create-a-virtual-private-gateway">3.3 On the AWS side create a Virtual Private Gateway<a href="#33-on-the-aws-side-create-a-virtual-private-gateway" class="hash-link" aria-label="Direct link to 3.3 On the AWS side create a Virtual Private Gateway" title="Direct link to 3.3 On the AWS side create a Virtual Private Gateway">​</a></h5>
<p>Create an AWS Virtual Private Gateway and specify the name.</p>
<table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>ASN</td><td>Amazon Default ASN</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="34-on-the-aws-side-attach-the-virtual-private-gateway-to-the-vpc">3.4 On the AWS side attach the Virtual Private Gateway to the VPC<a href="#34-on-the-aws-side-attach-the-virtual-private-gateway-to-the-vpc" class="hash-link" aria-label="Direct link to 3.4 On the AWS side attach the Virtual Private Gateway to the VPC" title="Direct link to 3.4 On the AWS side attach the Virtual Private Gateway to the VPC">​</a></h5>
<p>Select the Virtual Private Gateway and then select Actions and <code>Attach to VPC</code> and select
the VPC in step 1</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="35-on-the-aws-side-create-the-site-to-site-vpn-connection">3.5 On the AWS side create the Site to Site VPN Connection<a href="#35-on-the-aws-side-create-the-site-to-site-vpn-connection" class="hash-link" aria-label="Direct link to 3.5 On the AWS side create the Site to Site VPN Connection" title="Direct link to 3.5 On the AWS side create the Site to Site VPN Connection">​</a></h5>
<p>Create an AWS Site-to-Site VPN Connection with the following settings</p>
<table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Target Gateway Type</td><td>Virtual Private Gateway</td></tr><tr><td>Virtual Private Gateway</td><td>Select the Virtual Private Gateway from step 3.3</td></tr><tr><td>Customer Gateway</td><td>Existing</td></tr><tr><td>Customer Gateway ID</td><td>Select the Customer Gateway from step 3.2</td></tr><tr><td>Routing Options</td><td>Static</td></tr><tr><td>Static IP Prefixes</td><td>Use the Azure VNet CIDR from step 2.1</td></tr><tr><td>Tunnel inside IP version</td><td>IPV4</td></tr></tbody></table>
<p>The other settings can remain as defaults or set to suit your requirements</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="36-download-the-vpn-connection-config-file">3.6 Download the VPN connection config file<a href="#36-download-the-vpn-connection-config-file" class="hash-link" aria-label="Direct link to 3.6 Download the VPN connection config file" title="Direct link to 3.6 Download the VPN connection config file">​</a></h5>
<p>Select the VPN connection once it has been created and use the following options and then save the file locally</p>
<table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Vendor</td><td>Generic</td></tr><tr><td>Platform</td><td>Generic</td></tr><tr><td>Software</td><td>Vendor Agnostic</td></tr></tbody></table>
<p>Save the file and open it. In there you will find the shared keys and putlic address for each tunnel created above</p>
<p>You need to use the <code>Pre-Shared Key</code> in the next step in Azure as well as the <code>public IP</code> of Tunnel 1 of the VPN
connection (There are two created, and we just use #1 for this example)</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="37-on-the-azure-side-create-a-local-network-gateway">3.7 On the Azure side create a Local Network Gateway<a href="#37-on-the-azure-side-create-a-local-network-gateway" class="hash-link" aria-label="Direct link to 3.7 On the Azure side create a Local Network Gateway" title="Direct link to 3.7 On the Azure side create a Local Network Gateway">​</a></h5>
<p>Create an Azure Local Network Gateway using the pubic IP address from step 3.6 of the tunnel and the CIDR block of
the AWS VPC</p>
<table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Endpoint</td><td>IP Address</td></tr><tr><td>IP Address</td><td>Use the IP address from step 3.6 of the VPN Connection</td></tr><tr><td>Address space</td><td>Use the AWS CIDR block from step 1</td></tr><tr><td>Configure BGP</td><td>No</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="38-on-the-azure-side-create-a-connection-on-the-existing-virtual-network-gateway">3.8 On the Azure side create a Connection on the existing Virtual Network Gateway<a href="#38-on-the-azure-side-create-a-connection-on-the-existing-virtual-network-gateway" class="hash-link" aria-label="Direct link to 3.8 On the Azure side create a Connection on the existing Virtual Network Gateway" title="Direct link to 3.8 On the Azure side create a Connection on the existing Virtual Network Gateway">​</a></h5>
<p>Open the settings of the Virtual Network Gateway created in step 3.1. Then select <code>Connections</code> and <code>Add</code>.
Use the settings below</p>
<table><thead><tr><th>Setting</th><th>Value</th></tr></thead><tbody><tr><td>Connection Type</td><td>Site-to-Site IPSec</td></tr><tr><td>Virtual Network Gateway</td><td>Use the Virtual Network Gateway created in step 3.1</td></tr><tr><td>Local Network Gateway</td><td>Use the Local Network Gateway created in step 3.7</td></tr><tr><td>Authentication method</td><td>Shared Key (PSK)</td></tr><tr><td>Shared Key(PSK)</td><td>Use the key from the config file downloaded in step 3.6</td></tr><tr><td>IKE Protocol</td><td>IKEv2</td></tr><tr><td>BGP</td><td>Disabled</td></tr><tr><td>Use policy based traffic selector</td><td>Disabled</td></tr></tbody></table>
<p>The other settings can remain as defaults or set to suit your requirements</p>
<p>This may take a few minutes to setup. Once complete you should see the Tunnel from step 3.5 status show as <code>UP</code></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="39-high-availability-on-the-azure-side">3.9 High Availability on the Azure side<a href="#39-high-availability-on-the-azure-side" class="hash-link" aria-label="Direct link to 3.9 High Availability on the Azure side" title="Direct link to 3.9 High Availability on the Azure side">​</a></h5>
<p>If you need high availability or this is a production setup, please use Tunnel #2 to create a second
Local Network Gateway (step 3.7) and then a second connection on the Virtual Network Gateway (step 3.8)</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="310-on-aws-update-the-subnet-route-table">3.10 On AWS update the subnet route table<a href="#310-on-aws-update-the-subnet-route-table" class="hash-link" aria-label="Direct link to 3.10 On AWS update the subnet route table" title="Direct link to 3.10 On AWS update the subnet route table">​</a></h5>
<p>On the AWS side please update the route tables of your subnets to use the Virtual gateway and set the destination
as the Azure VNet CIDR block</p>
<table><thead><tr><th>Destination</th><th>Target</th></tr></thead><tbody><tr><td>10.1.0.0/16</td><td>vgw -.....</td></tr></tbody></table>
<p>Please replace the Azure CIDR block with that of your own and select the id of the Virtual Gateway from step 3.3</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Also note that if each subnet has a different route table, then this change needs to be added to each subnet that you
EKS nodes with Besu running on them</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-update-security-groups-to-allow-traffic">4. Update security groups to allow traffic<a href="#4-update-security-groups-to-allow-traffic" class="hash-link" aria-label="Direct link to 4. Update security groups to allow traffic" title="Direct link to 4. Update security groups to allow traffic">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="41-on-aws-side">4.1 On AWS side<a href="#41-on-aws-side" class="hash-link" aria-label="Direct link to 4.1 On AWS side" title="Direct link to 4.1 On AWS side">​</a></h5>
<p>Find the security group of the node pool that contains your Besu nodes and add this in to the <code>Inbound</code> rules to allow
traffic from the Azure VNet</p>
<table><thead><tr><th>Type</th><th>Protocol</th><th>Port range</th><th>Destination</th><th>Description</th></tr></thead><tbody><tr><td>Custom UDP</td><td>UDP</td><td><code>30303</code></td><td><code>10.1.0.0/16</code></td><td>Azure</td></tr><tr><td>Custom TCP</td><td>TCP</td><td><code>30303</code></td><td><code>10.1.0.0/16</code></td><td>Azure</td></tr><tr><td>Custom TCP</td><td>TCP</td><td><code>8545 </code></td><td><code>10.1.0.0/16</code></td><td>Azure</td></tr></tbody></table>
<p>Please update the CIDR to only be a subnet CIDR if you have your nodes in select subnets.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="42-on-azure-side">4.2 On Azure side<a href="#42-on-azure-side" class="hash-link" aria-label="Direct link to 4.2 On Azure side" title="Direct link to 4.2 On Azure side">​</a></h5>
<p>Find the network security group of the node pool that contains your Besu nodes and add this in to the <code>Inbound</code> rules to allow
traffic from the Azure VNet</p>
<table><thead><tr><th>Type</th><th>Protocol</th><th>Port range</th><th>Destination</th><th>Name</th></tr></thead><tbody><tr><td>UDP</td><td>UDP</td><td><code>30303</code></td><td><code>10.0.0.0/16</code></td><td>AWS</td></tr><tr><td>TCP</td><td>TCP</td><td><code>30303</code></td><td><code>10.0.0.0/16</code></td><td>AWS</td></tr><tr><td>TCP</td><td>TCP</td><td><code>8545 </code></td><td><code>10.0.0.0/16</code></td><td>AWS</td></tr></tbody></table>
<p>Please update the CIDR to only be a subnet CIDR if you have your nodes in select subnets.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/hyperledger/besu-docs/tree/main/docs/private-networks/tutorials/kubernetes/multi-cluster.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_VsjB"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-04-28T00:11:02.000Z" itemprop="dateModified">Apr 28, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/private-networks/tutorials/kubernetes/production"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Production</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/private-networks/tutorials/azure"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploy using Microsoft Azure</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#steps" class="table-of-contents__link toc-highlight">Steps</a><ul><li><a href="#1-create-an-awc-vpc" class="table-of-contents__link toc-highlight">1. Create an AWC VPC</a></li><li><a href="#2-create-an-azure-virtual-network" class="table-of-contents__link toc-highlight">2. Create an Azure Virtual Network</a></li><li><a href="#3-connect-the-aws-vpc-and-azure-vnet-with-a-site-to-site-vpn" class="table-of-contents__link toc-highlight">3. Connect the AWS VPC and Azure VNet with a site to site VPN</a><ul><li><a href="#31-on-the-azure-side-create-a-virtual-network-gateway" class="table-of-contents__link toc-highlight">3.1 On the Azure side create a Virtual Network Gateway</a></li><li><a href="#32-on-the-aws-side-create-a-customer-gateway" class="table-of-contents__link toc-highlight">3.2 On the AWS side create a Customer Gateway</a></li><li><a href="#33-on-the-aws-side-create-a-virtual-private-gateway" class="table-of-contents__link toc-highlight">3.3 On the AWS side create a Virtual Private Gateway</a></li><li><a href="#34-on-the-aws-side-attach-the-virtual-private-gateway-to-the-vpc" class="table-of-contents__link toc-highlight">3.4 On the AWS side attach the Virtual Private Gateway to the VPC</a></li><li><a href="#35-on-the-aws-side-create-the-site-to-site-vpn-connection" class="table-of-contents__link toc-highlight">3.5 On the AWS side create the Site to Site VPN Connection</a></li><li><a href="#36-download-the-vpn-connection-config-file" class="table-of-contents__link toc-highlight">3.6 Download the VPN connection config file</a></li><li><a href="#37-on-the-azure-side-create-a-local-network-gateway" class="table-of-contents__link toc-highlight">3.7 On the Azure side create a Local Network Gateway</a></li><li><a href="#38-on-the-azure-side-create-a-connection-on-the-existing-virtual-network-gateway" class="table-of-contents__link toc-highlight">3.8 On the Azure side create a Connection on the existing Virtual Network Gateway</a></li><li><a href="#39-high-availability-on-the-azure-side" class="table-of-contents__link toc-highlight">3.9 High Availability on the Azure side</a></li><li><a href="#310-on-aws-update-the-subnet-route-table" class="table-of-contents__link toc-highlight">3.10 On AWS update the subnet route table</a></li></ul></li><li><a href="#4-update-security-groups-to-allow-traffic" class="table-of-contents__link toc-highlight">4. Update security groups to allow traffic</a><ul><li><a href="#41-on-aws-side" class="table-of-contents__link toc-highlight">4.1 On AWS side</a></li><li><a href="#42-on-azure-side" class="table-of-contents__link toc-highlight">4.2 On Azure side</a></li></ul></li></ul></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Public networks</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/public-networks">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/public-networks/how-to">How to guides</a></li><li class="footer__item"><a class="footer__link-item" href="/public-networks/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/public-networks/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/public-networks/reference">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Private networks</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/private-networks">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/private-networks/how-to">How to guides</a></li><li class="footer__item"><a class="footer__link-item" href="/private-networks/concepts">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/private-networks/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/private-networks/reference">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/hyperledger" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://lf-hyperledger.atlassian.net/wiki/spaces/BESU/overview" target="_blank" rel="noopener noreferrer" class="footer__link-item">Besu Wiki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/HyperledgerBesu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Besu Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/hyperledger/besu/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Besu GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/hyperledger/besu-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Besu documentation GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.hyperledger.org/use/besu" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/logo.svg" alt="Besu logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="250"><img src="/img/logo-reversed.svg" alt="Besu logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="250"></a></div><div class="footer__copyright">Besu and its documentation are licensed under the Apache 2.0 license.</div></div></div></footer></div>
</body>
</html>